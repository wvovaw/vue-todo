"use strict";(self["webpackChunktodo_ta"]=self["webpackChunktodo_ta"]||[]).push([[922],{3987:function(t,e,s){s.d(e,{Z:function(){return _}});var o=s(3396),n=s(7139);const a=t=>((0,o.dD)("data-v-16369660"),t=t(),(0,o.Cn)(),t),i={class:"modal is-active"},l=a((()=>(0,o._)("div",{class:"modal-background"},null,-1))),d={class:"modal-card"},r={class:"modal-card-head"},c={class:"modal-card-title"},u={class:"modal-card-body"},h={class:"modal-card-foot"};function p(t,e,s,a,p,g){return(0,o.wg)(),(0,o.iD)("div",i,[l,(0,o._)("div",d,[(0,o._)("header",r,[(0,o._)("p",c,(0,n.zw)(s.title),1),(0,o._)("button",{class:"delete","aria-label":"close",onClick:e[0]||(e[0]=e=>t.$emit("cancel"))})]),(0,o._)("section",u,[(0,o._)("p",null,(0,n.zw)(s.subtitle),1)]),(0,o._)("footer",h,[(0,o._)("button",{class:"button is-medium",onClick:e[1]||(e[1]=e=>t.$emit("cancel"))},(0,n.zw)(s.cancelText),1),(0,o._)("button",{class:(0,n.C_)(["button is-medium",s.confirmBtnClass]),onClick:e[2]||(e[2]=e=>t.$emit("confirm"))},(0,n.zw)(s.confirmText),3)])])])}var g={props:{title:{type:String,default:""},subtitle:{type:String,default:""},cancelText:{type:String,default:"Cancel"},confirmText:{type:String,default:"Confirm"},confirmBtnClass:{type:String,default:"is-danger"}}},m=s(89);const f=(0,m.Z)(g,[["render",p],["__scopeId","data-v-16369660"]]);var _=f},5068:function(t,e,s){s.r(e),s.d(e,{default:function(){return G}});var o=s(3396),n=s(7139),a=s(9242);const i=t=>((0,o.dD)("data-v-166f0823"),t=t(),(0,o.Cn)(),t),l={class:"edit"},d={class:"buttons"},r=i((()=>(0,o._)("span",{class:"icon"},[(0,o._)("i",{class:"fas fa-floppy-disk"})],-1))),c=i((()=>(0,o._)("span",null,"Save changes",-1))),u=[r,c],h=i((()=>(0,o._)("span",{class:"icon"},[(0,o._)("i",{class:"fas fa-rotate-left"})],-1))),p=i((()=>(0,o._)("span",null,"Revert changes",-1))),g=[h,p],m=i((()=>(0,o._)("span",{class:"icon"},[(0,o._)("i",{class:"fas fa-door-open"})],-1))),f=i((()=>(0,o._)("span",null,"Exit",-1))),_=[m,f],v=i((()=>(0,o._)("span",{class:"icon"},[(0,o._)("i",{class:"fas fa-trash"})],-1))),w=i((()=>(0,o._)("span",null,"Delete note",-1))),b=[v,w],y={class:"buttons"},C=["disabled"],$=i((()=>(0,o._)("span",{class:"icon"},[(0,o._)("i",{class:"fas fa-rotate-left"})],-1))),k=i((()=>(0,o._)("span",null,"Undo",-1))),D=[$,k],I=["disabled"],N=i((()=>(0,o._)("span",{class:"icon"},[(0,o._)("i",{class:"fas fa-rotate-right"})],-1))),T=i((()=>(0,o._)("span",null,"Redo",-1))),x=[N,T],E={class:"buttons"},S={class:"note-title"},B=i((()=>(0,o._)("label",null,[(0,o._)("strong",null,"Note title: ")],-1))),M={class:"todo-list"};function U(t,e,s,i,r,c){const h=(0,o.up)("ControlsBar"),p=(0,o.up)("TodoItem"),m=(0,o.up)("ModalDialog");return(0,o.wg)(),(0,o.iD)("div",l,[(0,o.Wm)(h,null,{left:(0,o.w5)((()=>[(0,o.Uk)((0,n.zw)(r.note.title),1)])),right:(0,o.w5)((()=>[(0,o._)("div",d,[(0,o._)("button",{class:"button is-small is-success",onClick:e[0]||(e[0]=t=>c.runDialog(r.modal.types.save))},u),(0,o._)("button",{class:"button is-small is-warning",onClick:e[1]||(e[1]=t=>c.runDialog(r.modal.types.revert))},g),(0,o._)("button",{class:"button is-small is-warning",onClick:e[2]||(e[2]=t=>c.runDialog(r.modal.types.exit))},_),(0,o._)("button",{class:"button is-small is-danger",onClick:e[3]||(e[3]=t=>c.runDialog(r.modal.types.delete))},b)])])),_:1}),(0,o.Wm)(h,{class:"mb-5"},{left:(0,o.w5)((()=>[(0,o._)("div",y,[(0,o._)("button",{class:"button is-small is-link is-inverted",onClick:e[4]||(e[4]=(...t)=>c.undoLastChange&&c.undoLastChange(...t)),disabled:!this.canUndo},D,8,C),(0,o._)("button",{class:"button is-small is-link is-inverted",onClick:e[5]||(e[5]=(...t)=>c.redoLastChange&&c.redoLastChange(...t)),disabled:!this.canRedo},x,8,I)])])),right:(0,o.w5)((()=>[(0,o._)("div",E,[(0,o._)("button",{class:"button is-small is-info is-inverted",onClick:e[6]||(e[6]=(...t)=>c.addTodoEntry&&c.addTodoEntry(...t))}," Add todo ")])])),_:1}),(0,o._)("div",S,[B,(0,o.wy)((0,o._)("input",{class:"input is-half-width",type:"text","onUpdate:modelValue":e[7]||(e[7]=t=>r.note.title=t)},null,512),[[a.nr,r.note.title]])]),(0,o._)("section",M,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(r.note.todo.length,((t,e)=>((0,o.wg)(),(0,o.j4)(p,{class:"todo-item",key:e,task:r.note.todo[e].task,done:r.note.todo[e].done,"onUpdate:task":t=>r.note.todo[e].task=t,"onUpdate:done":t=>r.note.todo[e].done=t,onDeleteTodo:t=>c.deleteTodoEntry(e)},null,8,["task","done","onUpdate:task","onUpdate:done","onDeleteTodo"])))),128)),(0,o.wy)((0,o._)("h1",null," Todo list is empty. Add some tasks ",512),[[a.F8,r.note.todo.length<1]])]),(0,o.wy)((0,o.Wm)(m,{title:r.modal.type.title,subtitle:r.modal.type.subtitle,"confirm-text":r.modal.type.confirmText,"confirm-btn-class":r.modal.type.confirmBtnClass,"cancel-text":r.modal.type.cancelText,onCancel:c.onDialogCancel,onConfirm:c.onDialogConfirm},null,8,["title","subtitle","confirm-text","confirm-btn-class","cancel-text","onCancel","onConfirm"]),[[a.F8,r.modal.show]])])}var O=s(7026);const J=t=>((0,o.dD)("data-v-5ddc4d9a"),t=t(),(0,o.Cn)(),t),Z={class:"item"},P=["checked"],W=J((()=>(0,o._)("span",null,null,-1))),z=["value"],L=J((()=>(0,o._)("span",{class:"icon"},[(0,o._)("i",{class:"fas fa-trash"})],-1))),R=[L];function F(t,e,s,n,a,i){return(0,o.wg)(),(0,o.iD)("div",Z,[(0,o._)("label",null,[(0,o._)("input",{type:"checkbox",checked:s.done,onClick:e[0]||(e[0]=e=>t.$emit("update:done",!s.done))},null,8,P),W]),(0,o._)("input",{class:"input ml-3 mr-3",type:"text",value:s.task,onInput:e[1]||(e[1]=e=>t.$emit("update:task",e.target.value))},null,40,z),(0,o._)("button",{class:"button is-ghost",onClick:e[2]||(e[2]=e=>t.$emit("deleteTodo"))},R)])}var A={name:"TodoItem",props:{task:{type:String,default:""},done:{type:Boolean,default:!1}},emits:["deleteTodo","update:task","update:done"],data(){return{}},methods:{}},K=s(89);const H=(0,K.Z)(A,[["render",F],["__scopeId","data-v-5ddc4d9a"]]);var V=H,Y=s(3987),j={name:"EditNoteView",components:{ControlsBar:O.Z,TodoItem:V,ModalDialog:Y.Z},data(){return{modal:{show:!1,type:{},types:{exit:{title:" Do you want to exit?",subtitle:"Unsaved changes won't be saved.",confirmBtnClass:"is-warning",callBack:this.exit},save:{title:" Save changes?",subtitle:"Are you sure you want to save changes?",confirmBtnClass:"is-success",callBack:this.saveChanges},revert:{title:"Revert changes?",subtitle:"Are you sure you want to revert all changes? It will restore the initial note state.",confirmBtnClass:"is-warning",callBack:this.revertChanges},delete:{title:"Delete note?",subtitle:"Carefull! this action can not be reverted!",confirmBtnClass:"is-danger",callBack:this.deleteNote}}},note:{},backupNote:{},pending:{},done:[],undone:[],newMutation:!1}},methods:{runDialog(t){this.modal.type=t,this.modal.show=!0},onDialogConfirm(){this.modal.type.callBack(),this.modal.show=!1},onDialogCancel(){this.modal.show=!1,this.modal.type={}},exit(){const t=this.$route.params.pageId;this.$router.push(`/page/${t}`)},deleteNote(){const t=this.$route.params.pageId;this.$store.dispatch("removeNote",{pageId:t,noteId:this.note.id}),this.$router.push(`/page/${t}`)},saveChanges(){const t=this.$route.params.pageId;if(this.$store.dispatch("pushNote",{pageId:t,note:JSON.parse(JSON.stringify(this.note))}),"new"==this.$route.params.noteId){const e=this.$store.getters.lastNote(t).id;this.note.id=e,this.$router.push(`/page/${t}/note/${e}`)}},revertChanges(){this.note=JSON.parse(this.backupNote),this.undone=[],this.done=[]},addTodoEntry(){this.note.todo.push({task:"",done:!1})},deleteTodoEntry(t){this.note.todo.splice(t,1)},undoLastChange(){this.canUndo&&(this.undone.push(JSON.stringify(this.note)),this.newMutation=!1,this.note=JSON.parse(this.done.pop()))},redoLastChange(){this.canRedo&&(this.done.push(JSON.stringify(this.note)),this.newMutation=!1,this.note=JSON.parse(this.undone.pop()))}},computed:{canUndo(){return this.done.length>0},canRedo(){return this.undone.length>0}},watch:{"note.todo":{deep:!0,handler(){this.newMutation?(this.undone=[],this.done.push(this.pending),this.pending=JSON.stringify(this.note)):(console.log("Working in history tree"),this.pending=JSON.stringify(this.note),this.newMutation=!0)}}},beforeCreate(){const t=this.$route.params.pageId,e=this.$route.params.noteId;"new"!=e&&void 0==this.$store.getters.noteById(t,e)&&(void 0==this.$store.getters.pageById(t)?this.$router.push("/"):this.$router.push(`/page/${t}`))},beforeMount(){const t=this.$route.params.pageId,e=this.$route.params.noteId;"new"==e&&(this.note=JSON.parse(JSON.stringify({title:"New note",todo:[]}))),void 0!=this.$store.getters.noteById(t,e)&&(this.note=JSON.parse(JSON.stringify(this.$store.getters.noteById(t,e)))),this.backupNote=this.pending=JSON.stringify(this.note)}};const q=(0,K.Z)(j,[["render",U],["__scopeId","data-v-166f0823"]]);var G=q},8443:function(t,e,s){s.r(e),s.d(e,{default:function(){return K}});var o=s(3396),n=s(7139),a=s(9242);const i=t=>((0,o.dD)("data-v-521adbfc"),t=t(),(0,o.Cn)(),t),l={class:"page"},d=(0,o.Uk)(" Notebook "),r={class:"buttons"},c={class:"tabs is-left is-boxed is-small"},u={class:"icon"},h=["onClick"],p=i((()=>(0,o._)("span",{class:"icon has-text-success"},[(0,o._)("i",{class:"fas fa-plus","aria-hidden":"true"})],-1))),g=[p];function m(t,e,s,i,p,m){const f=(0,o.up)("router-link"),_=(0,o.up)("ControlsBar"),v=(0,o.up)("EditableSpan"),w=(0,o.up)("NotesList"),b=(0,o.up)("ModalDialog");return(0,o.wg)(),(0,o.iD)("div",l,[(0,o.Wm)(_,null,{brand:(0,o.w5)((()=>[(0,o.Wm)(f,{class:"nav-item navbar-left label",to:"/"},{default:(0,o.w5)((()=>[d])),_:1})])),left:(0,o.w5)((()=>[(0,o.Uk)((0,n.zw)(m.pageTitle),1)])),right:(0,o.w5)((()=>[(0,o._)("div",r,[(0,o._)("button",{class:"button is-success is-small",onClick:e[0]||(e[0]=(...t)=>m.addNote&&m.addNote(...t))}," New note ")])])),_:1}),(0,o._)("div",c,[(0,o._)("ul",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.$store.getters.pages,(t=>((0,o.wg)(),(0,o.iD)("li",{class:(0,n.C_)({"is-active":m.pageId==t.id}),key:t.id},[(0,o.Wm)(f,{to:"/page/"+t.id},{default:(0,o.w5)((()=>[(0,o.Wm)(v,{data:t.title,"onUpdate:data":e[1]||(e[1]=t=>m.pageTitle=t)},null,8,["data"]),(0,o._)("span",u,[(0,o._)("button",{class:"delete is-small",onClick:(0,a.iM)((e=>{p.pageToRemove=t.id,p.showModal=!0}),["prevent"])},null,8,h)])])),_:2},1032,["to"])],2)))),128)),(0,o._)("li",null,[(0,o._)("a",{onClick:e[2]||(e[2]=(...t)=>m.addPage&&m.addPage(...t))},g)])])]),(0,o.Wm)(w),(0,o.wy)((0,o.Wm)(b,{title:"Delete page?",subtitle:"Are you sure you want to delete selected page?","confirm-text":"Delete","cancel-text":"Cancel",onCancel:e[3]||(e[3]=t=>p.showModal=!1),onConfirm:e[4]||(e[4]=t=>m.removePage(p.pageToRemove))},null,512),[[a.F8,p.showModal]])])}var f=s(7026);const _={class:"notes"};function v(t,e,s,n,i,l){const d=(0,o.up)("NoteEntity"),r=(0,o.up)("ModalDialog");return(0,o.wg)(),(0,o.iD)("div",_,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(l.notes,((t,s)=>((0,o.wg)(),(0,o.j4)(d,{key:s,note:t,onDeleteNote:e[0]||(e[0]=t=>l.openDialog(t))},null,8,["note"])))),128)),(0,o.wy)((0,o._)("h1",null," Notes list is empty. Create new one! ",512),[[a.F8,l.notes.length<1]]),(0,o.wy)((0,o.Wm)(r,{title:"Delete note?",subtitle:"Are you sure you want to delete this note?","confirm-text":"Delete","cancel-text":"Cancel",onCancel:e[1]||(e[1]=t=>i.showModal=!1),onConfirm:l.deleteNote},null,8,["onConfirm"]),[[a.F8,i.showModal]])])}const w=t=>((0,o.dD)("data-v-7a31b5a7"),t=t(),(0,o.Cn)(),t),b={class:"note"},y={class:"note-header"},C={class:"title is-5 note-title"},$={class:"todo-list"},k=["todo"],D=["checked"],I=w((()=>(0,o._)("span",null,null,-1))),N=w((()=>(0,o._)("b",null,". . .",-1))),T=[N];function x(t,e,s,i,l,d){const r=(0,o.up)("router-link");return(0,o.wg)(),(0,o.iD)("section",b,[(0,o._)("div",y,[(0,o.Wm)(r,{to:`/page/${this.$route.params.id}/note/${s.note.id}`},{default:(0,o.w5)((()=>[(0,o._)("h5",C,(0,n.zw)(s.note.title),1)])),_:1},8,["to"]),(0,o._)("button",{class:"delete is-medium",onClick:e[0]||(e[0]=e=>t.$emit("deleteNote",s.note.id))})]),(0,o._)("div",$,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(s.note.todo.slice(0,5),((t,e)=>((0,o.wg)(),(0,o.iD)("div",{class:"todo-item",key:e,todo:t},[(0,o._)("label",null,[(0,o._)("input",{type:"checkbox",checked:t.done,disabled:""},null,8,D),I,(0,o.Uk)(" "+(0,n.zw)(t.task),1)])],8,k)))),128))]),(0,o.wy)((0,o._)("div",null,T,512),[[a.F8,s.note.todo.length>5]])])}var E={name:"NoteEntity",components:{},props:{note:{type:Object,default(){}}},methods:{}},S=s(89);const B=(0,S.Z)(E,[["render",x],["__scopeId","data-v-7a31b5a7"]]);var M=B,U=s(3987),O={name:"NotesList",components:{NoteEntity:M,ModalDialog:U.Z},props:{},data(){return{showModal:!1,noteIdToDelete:0}},computed:{notes(){const t=this.$store.getters.pageById(this.$route.params.id);return void 0!=t?t.notes:[]}},methods:{openDialog(t){this.noteIdToDelete=t,this.showModal=!0},deleteNote(){this.$store.dispatch("removeNote",{pageId:this.$route.params.id,noteId:this.noteIdToDelete}),this.showModal=!1,this.noteIdtoDelete=null}}};const J=(0,S.Z)(O,[["render",v],["__scopeId","data-v-d7a1e7b6"]]);var Z=J;const P={class:"editable-span"};function W(t,e,s,i,l,d){return(0,o.wg)(),(0,o.iD)("div",P,[(0,o.wy)((0,o._)("span",{onDblclick:e[0]||(e[0]=(...t)=>d.toggleEdit&&d.toggleEdit(...t))},(0,n.zw)(s.data),545),[[a.F8,!l.isEditing]]),(0,o.wy)((0,o._)("input",{onkeypress:"this.style.width = this.value.length + 2 + 'ch';",class:"tiny-input",type:"text","onUpdate:modelValue":e[1]||(e[1]=t=>l.data2=t),onBlur:e[2]||(e[2]=t=>d.confirmEdit()),onKeydown:e[3]||(e[3]=(0,a.D2)((t=>d.confirmEdit()),["enter"])),ref:"input"},null,544),[[a.F8,l.isEditing],[a.nr,l.data2]])])}var z={name:"EditableSpan",props:{data:{type:String,default:""}},emits:["update:data"],data(){return{data2:this.data,isEditing:!1}},methods:{toggleEdit(){this.isEditing?(this.isEditing=!1,this.$refs.input.blur()):(this.isEditing=!0,this.$refs.input.style.width=this.$refs.input.value.length+2+"ch",setTimeout((()=>this.$refs.input.focus()),0))},confirmEdit(){""!=this.data2&&this.$emit("update:data",this.data2),this.isEditing=!1},cancelEdit(){this.data2=this.data,this.$emit("update:data",this.data2),this.isEditing=!1}}};const L=(0,S.Z)(z,[["render",W],["__scopeId","data-v-6d389f52"]]);var R=L,F={name:"PageView",components:{ControlsBar:f.Z,NotesList:Z,EditableSpan:R,ModalDialog:U.Z},data(){return{showModal:!1,pageToRemove:null}},computed:{pageId(){return this.$route.params.id},pageTitle:{get(){const t=this.$store.getters.pageById(this.pageId);return void 0!=t?t.title:null},set(t){const e=this.$store.getters.pageById(this.pageId);void 0!=e&&(e.title=t,this.$store.dispatch("pushPage",e))}}},methods:{addPage(){this.$store.dispatch("pushPage",{title:"New page",notes:[],notesIdCounter:0}),this.$router.push(`/page/${this.$store.getters.lastPage.id}`)},removePage(t){this.showModal=!1;let e=this.$store.getters.pages;if(t!=this.pageId)this.$store.dispatch("removePage",t);else if(e.length>1){const s=e.findIndex((e=>e.id==t));this.$store.dispatch("removePage",t),e=this.$store.getters.pages,void 0!=e[s]?this.$router.push(`/page/${e[s].id}/`):this.$router.push(`/page/${e[s-1].id}`)}else this.$router.push("/pages/").then((()=>{this.$store.dispatch("removePage",t)}))},addNote(){this.$router.push(`/page/${this.$route.params.id}/note/new`)}}};const A=(0,S.Z)(F,[["render",m],["__scopeId","data-v-521adbfc"]]);var K=A}}]);
//# sourceMappingURL=edit.d13e3bbf.js.map